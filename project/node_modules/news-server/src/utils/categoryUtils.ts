/**
 * Map category slug to category name
 */
export const categorySlugMap: Record<string, string> = {
    'thoi-su': 'Thời sự',
    'the-gioi': 'Thế giới',
    'kinh-doanh': 'Kinh doanh',
    'the-thao': 'Thể thao',
    'giai-tri': 'Giải trí',
    'phap-luat': 'Pháp luật',
    'giao-duc': 'Giáo dục',
    'suc-khoe': 'Sức khỏe',
    'doi-song': 'Đời sống',
    'du-lich': 'Du lịch',
    'khoa-hoc': 'Khoa học',
    'cong-nghe': 'Công nghệ',
    'xe': 'Xe',
    'y-kien': 'Ý kiến',
    'tam-su': 'Tâm sự',
    'cam-nang': 'Cẩm nang',
    'ban-doc': 'Bạn đọc',
    'the-thao-24h': 'Thể thao 24h',
    'bong-da': 'Bóng đá',
    'tennis': 'Tennis',
    'golf': 'Golf',
    'du-hoc': 'Du học',
    'khoa-hoc-cong-nghe': 'Khoa học công nghệ',
    'the-gioi-tre': 'Thế giới trẻ',
    'ban-doc-lam-bao': 'Bạn đọc làm báo',
    'tam-long-nhan-ai': 'Tấm lòng nhân ái',
    'song-khoe': 'Sống khỏe',
    'am-thuc': 'Ẩm thực',
    'lam-dep': 'Làm đẹp',
    'thi-truong-tieu-dung': 'Thị trường tiêu dùng',
    'bat-dong-san': 'Bất động sản',
    'tai-chinh': 'Tài chính',
    'ngan-hang': 'Ngân hàng',
    'chung-khoan': 'Chứng khoán',
    'doanh-nghiep': 'Doanh nghiệp',
    'tieu-dung-thong-minh': 'Tiêu dùng thông minh',
    'tuyen-sinh': 'Tuyển sinh',
    'du-hoc-nghe-nghiep': 'Du học nghề',
    'khoa-hoc-may-tinh': 'Khoa học máy tính',
    'cong-nghe-moi': 'Công nghệ mới',
    'sang-kien': 'Sáng kiến',
    'ung-dung': 'Ứng dụng',
    'kham-pha': 'Khám phá',
    'khoa-hoc-doi-song': 'Khoa học đời sống',
    'the-gioi-dong-vat': 'Thế giới động vật',
    'kien-thuc': 'Kiến thức',
    'khoa-hoc-vu-tru': 'Khoa học vũ trụ',
    'khoa-hoc-quan-ta': 'Khoa học quân sự',
    'khoa-hoc-cong-nghe-moi': 'Khoa học công nghệ mới',
    'khoa-hoc-xa-hoi': 'Khoa học xã hội',
    'khoa-hoc-tu-nhien': 'Khoa học tự nhiên',
    'khoa-hoc-cong-nghe-thong-tin': 'Công nghệ thông tin',
    'khoa-hoc-may-tinh-va-cntt': 'Khoa học máy tính và CNTT',
    'khoa-hoc-ky-thuat': 'Khoa học kỹ thuật',
    'khoa-hoc-giao-duc': 'Khoa học giáo dục',
    'khoa-hoc-y-duoc': 'Khoa học y dược',
    'khoa-hoc-nong-nghiep': 'Khoa học nông nghiệp',
    'khoa-hoc-moi-truong': 'Khoa học môi trường',
    'khoa-hoc-xay-dung': 'Khoa học xây dựng',
    'khoa-hoc-giao-thong': 'Khoa học giao thông',
    'khoa-hoc-vat-lieu': 'Khoa học vật liệu',
    'khoa-hoc-nang-luong': 'Khoa học năng lượng',
    'khoa-hoc-bien': 'Khoa học biển',
    'khoa-hoc-khac': 'Khoa học khác',
    'the-thao-the-gioi': 'Thể thao thế giới',
    'the-thao-viet-nam': 'Thể thao Việt Nam',
    'bong-da-anh': 'Bóng đá Anh',
    'bong-da-tbn': 'Bóng đá Tây Ban Nha',
    'bong-da-duc': 'Bóng đá Đức',
    'bong-da-y': 'Bóng đá Ý',
    'bong-da-phap': 'Bóng đá Pháp',
    'bong-da-viet-nam': 'Bóng đá Việt Nam',
    'bong-da-chau-a': 'Bóng đá châu Á',
    'bong-da-chau-au': 'Bóng đá châu Âu',
    'bong-da-nam': 'Bóng đá nam',
    'bong-da-nu': 'Bóng đá nữ',
    'bong-da-u23': 'Bóng đá U23',
    'bong-da-u20': 'Bóng đá U20',
    'bong-da-u17': 'Bóng đá U17',
    'bong-da-clb': 'Bóng đá CLB',
    'bong-da-quoc-te': 'Bóng đá quốc tế',
    'bong-da-viet-nam-clb': 'Bóng đá Việt Nam CLB',
    'bong-da-viet-nam-doi-tuyen': 'Bóng đá Việt Nam đội tuyển',
    'bong-da-viet-nam-hang-nhat': 'Bóng đá Việt Nam hạng nhất',
    'bong-da-viet-nam-hang-nhi': 'Bóng đá Việt Nam hạng nhì',
    'bong-da-viet-nam-hang-ba': 'Bóng đá Việt Nam hạng ba',
    'bong-da-viet-nam-hang-tu': 'Bóng đá Việt Nam hạng tư',
    'bong-da-viet-nam-hang-nam': 'Bóng đá Việt Nam hạng năm',
    'bong-da-viet-nam-hang-sau': 'Bóng đá Việt Nam hạng sáu',
    'bong-da-viet-nam-hang-bay': 'Bóng đá Việt Nam hạng bảy',
    'bong-da-viet-nam-hang-tam': 'Bóng đá Việt Nam hạng tám',
    'bong-da-viet-nam-hang-chin': 'Bóng đá Việt Nam hạng chín',
    'bong-da-viet-nam-hang-muoi': 'Bóng đá Việt Nam hạng mười',
    'bong-da-viet-nam-hang-muoi-mot': 'Bóng đá Việt Nam hạng mười một',
    'bong-da-viet-nam-hang-muoi-hai': 'Bóng đá Việt Nam hạng mười hai',
    'bong-da-viet-nam-hang-muoi-ba': 'Bóng đá Việt Nam hạng mười ba',
    'bong-da-viet-nam-hang-muoi-bon': 'Bóng đá Việt Nam hạng mười bốn',
    'bong-da-viet-nam-hang-muoi-lam': 'Bóng đá Việt Nam hạng mười lăm',
    'bong-da-viet-nam-hang-muoi-sau': 'Bóng đá Việt Nam hạng mười sáu',
    'bong-da-viet-nam-hang-muoi-bay': 'Bóng đá Việt Nam hạng mười bảy',
    'bong-da-viet-nam-hang-muoi-tam': 'Bóng đá Việt Nam hạng mười tám',
    'bong-da-viet-nam-hang-muoi-chin': 'Bóng đá Việt Nam hạng mười chín',
    'bong-da-viet-nam-hang-hai-muoi': 'Bóng đá Việt Nam hạng hai mươi',
};

/**
 * Get category name from slug
 */
export function getCategoryFromSlug(slug: string): string {
    return categorySlugMap[slug] || 'Tin tức';
}

/**
 * Determine category based on title, content and image URL
 */
export function determineCategory(title: string, content: string = '', imageUrl: string = ''): string {
    if (!title) return 'Tin tức';
    
    const contentLower = title.toLowerCase() + ' ' + content.toLowerCase();
    const titleLower = title.toLowerCase();
    const imageUrlLower = imageUrl?.toLowerCase() || '';
    
    // Category scores
    const categoryScores: Record<string, number> = {};
    
    // Category keywords
    const categoryKeywords: Record<string, {keywords: string[], weight: number}[]> = {
        'Thể thao': [
            { keywords: ['bóng đá', 'bóng rổ', 'tennis', 'cầu lông', 'bơi lội', 'điền kinh', 'thể thao'], weight: 3 },
            { keywords: ['vđv', 'vận động viên', 'tranh tài', 'giải đấu', 'vô địch', 'huy chương'], weight: 2 },
            { keywords: ['premier league', 'la liga', 'serie a', 'bundesliga', 'world cup', 'asiad'], weight: 2 }
        ],
        'Công nghệ': [
            { keywords: ['công nghệ', 'smartphone', 'máy tính', 'laptop', 'điện thoại', 'ai', 'trí tuệ nhân tạo', 'blockchain', 'iot', 'internet vạn vật'], weight: 3 },
            { keywords: ['app', 'ứng dụng', 'phần mềm', 'máy tính bảng', 'thông minh', 'kỹ thuật số', 'công nghệ số', 'chuyển đổi số'], weight: 2 },
            { keywords: ['apple', 'samsung', 'xiaomi', 'google', 'microsoft', 'amazon', 'meta', 'tesla'], weight: 1 }
        ],
        'Khoa học': [
            { keywords: ['khoa học', 'nghiên cứu', 'phát minh', 'sáng chế', 'vũ trụ', 'thiên văn', 'vật lý', 'hóa học'], weight: 3 },
            { keywords: ['nghiên cứu khoa học', 'phòng thí nghiệm', 'nhà khoa học', 'công bố quốc tế', 'tạp chí khoa học'], weight: 2 },
            { keywords: ['nasa', 'esa', 'spacex', 'hố đen', 'hành tinh', 'thiên hà'], weight: 1 }
        ],
        'Xe': [
            { keywords: ['xe hơi', 'ô tô', 'xe máy', 'xe điện', 'xe tự lái', 'siêu xe', 'xe đua'], weight: 3 },
            { keywords: ['hãng xe', 'đánh giá xe', 'xe mới ra mắt', 'xe thể thao', 'xe sang', 'xe cổ'], weight: 2 },
            { keywords: ['toyota', 'honda', 'yamaha', 'vinfast', 'tesla', 'ferrari', 'lamborghini', 'porsche'], weight: 1 }
        ],
        'Giáo dục': [
            { keywords: ['giáo dục', 'học sinh', 'sinh viên', 'giáo viên', 'trường học', 'đại học'], weight: 3 },
            { keywords: ['thi cử', 'tuyển sinh', 'điểm thi', 'học bổng', 'đào tạo', 'bài giảng'], weight: 2 },
            { keywords: ['bộ giáo dục', 'sách giáo khoa', 'chương trình học', 'lớp học'], weight: 1 }
        ],
        'Sức khỏe': [
            { keywords: ['sức khỏe', 'bệnh viện', 'bác sĩ', 'điều trị', 'thuốc', 'dịch bệnh'], weight: 3 },
            { keywords: ['covid', 'vaccine', 'tiêm chủng', 'khám bệnh', 'chữa bệnh', 'sơ cứu'], weight: 2 },
            { keywords: ['ung thư', 'tim mạch', 'tiểu đường', 'huyết áp', 'sốt xuất huyết'], weight: 1 }
        ],
        'Du lịch': [
            { keywords: ['du lịch', 'điểm đến', 'khách sạn', 'resort', 'phượt', 'tour'], weight: 3 },
            { keywords: ['vé máy bay', 'đặt phòng', 'kinh nghiệm', 'hướng dẫn viên', 'lữ hành'], weight: 2 },
            { keywords: ['biển đảo', 'núi rừng', 'di sản', 'văn hóa', 'ẩm thực'], weight: 1 }
        ],
        'Kinh doanh': [
            { keywords: ['kinh doanh', 'doanh nghiệp', 'thị trường', 'cổ phiếu', 'chứng khoán', 'đầu tư'], weight: 3 },
            { keywords: ['tài chính', 'ngân hàng', 'lãi suất', 'tỷ giá', 'bất động sản', 'bđs'], weight: 2 },
            { keywords: ['khởi nghiệp', 'startup', 'vốn', 'lợi nhuận', 'thuế', 'hải quan'], weight: 1 }
        ],
        'Giải trí': [
            { keywords: ['giải trí', 'sao', 'ngôi sao', 'phim', 'nhạc', 'truyền hình'], weight: 3 },
            { keywords: ['thần tượng', 'liveshow', 'phim ảnh', 'âm nhạc', 'nghệ sĩ', 'diễn viên'], weight: 2 },
            { keywords: ['sao việt', 'sao hàn', 'sao âu mỹ', 'phim chiếu rạp', 'phim truyền hình'], weight: 1 }
        ],
        'Thời sự': [
            { keywords: ['thời sự', 'chính trị', 'quốc hội', 'chính phủ', 'thủ tướng', 'chủ tịch nước'], weight: 3 },
            { keywords: ['luật', 'nghị định', 'thông tư', 'văn bản pháp luật', 'cải cách'], weight: 2 },
            { keywords: ['an ninh', 'quốc phòng', 'đối ngoại', 'hội nhập', 'đảng', 'nhà nước'], weight: 1 }
        ],
        'Pháp luật': [
            { keywords: ['pháp luật', 'tòa án', 'vi phạm', 'kiện tụng', 'hình sự', 'dân sự'], weight: 3 },
            { keywords: ['công an', 'điều tra', 'bắt giữ', 'tạm giam', 'khởi tố', 'truy tố'], weight: 2 },
            { keywords: ['án mạng', 'trộm cắp', 'lừa đảo', 'ma túy', 'đánh bạc', 'cướp giật'], weight: 1 }
        ],
        'Thế giới': [
            { keywords: ['thế giới', 'quốc tế', 'đối ngoại', 'ngoại giao', 'hội nhập', 'toàn cầu'], weight: 3 },
            { keywords: ['mỹ', 'trung quốc', 'nhật bản', 'hàn quốc', 'châu âu', 'đông nam á'], weight: 2 },
            { keywords: ['liên hợp quốc', 'who', 'wto', 'asean', 'eu', 'nato'], weight: 1 }
        ]
    };
    
    // Calculate category score based on title and content
    for (const [category, keywordGroups] of Object.entries(categoryKeywords)) {
        let score = 0;
        
        for (const {keywords, weight} of keywordGroups) {
            for (const keyword of keywords) {
                if (titleLower.includes(keyword)) {
                    score += weight * 3; // Higher weight if keyword is in title
                }
                if (contentLower.includes(keyword)) {
                    score += weight;
                }
            }
        }
        
        // Check image URL
        const imageCategories: Record<string, string[]> = {
            'Thể thao': ['thethao', 'bongda', 'bongro', 'tennis', 'vandongvien', 'thethao247'],
            'Công nghệ': ['congnghe', 'dienthoai', 'laptop', 'smartphone', 'tech', 'gadget'],
            'Giải trí': ['giaitri', 'sao', 'ngoisao', 'phim', 'music', 'entertainment'],
            'Sức khỏe': ['suckhoe', 'yte', 'benhvien', 'bacsi', 'health', 'medical'],
            'Du lịch': ['dulich', 'travel', 'phuot', 'tour', 'resort', 'khachsan'],
            'Ẩm thực': ['monngon', 'food', 'anuong', 'nauan', 'amthuc', 'monan'],
            'Khoa học': ['khoahoc', 'khoa-hoc', 'science', 'research', 'nghiencuu', 'khoa-hoc-cong-nghe'],
            'Xe': ['xehoi', 'xemay', 'xe', 'car', 'bike', 'motor', 'automotive', 'oto', 'xedien', 'xetulai', 'xe-dien', 'xe-tu-lai'],
            'Bất động sản': ['bds', 'nha', 'chungcu', 'canho', 'realestate', 'property'],
        };
        
        for (const [cat, paths] of Object.entries(imageCategories)) {
            if (cat === category && paths.some(path => imageUrlLower.includes(path))) {
                score += 5; // Add points if image URL contains category keywords
            }
        }
        
        if (score > 0) {
            categoryScores[category] = score;
        }
    }
    
    // Find category with highest score
    let bestCategory = 'Tin tức';
    let highestScore = 0;
    
    for (const [category, score] of Object.entries(categoryScores)) {
        if (score > highestScore) {
            highestScore = score;
            bestCategory = category;
        }
    }
    
    // Minimum score to determine category
    return highestScore >= 3 ? bestCategory : 'Tin tức';
}
